# crypto/lazy-bigrams Writeup
319 solves | 104 points | Difficulty: Baby  
**TLDR: Decode a bigram substituion using known plaintext and plaintext structure.**
## Description
```
Don't feel like writing a plaintext...
  
Flag is all lowercase.
```
The challenge consists of 2 files: `ct.txt` and `chall.py`.
The first is the ciphertext and the second is a script 
## Solve
`chall.py` is a script that takes the flag as `flag` and encodes it as follows:
- Convert the string to uppercase and substitute each character in the flag with it's corresponding "phonetically mapped" word. This phonetic mapping consists of NATO phonetic alphabet, the word forms of the digits, and separate mappings for the underscore and the curly braces. To endure a proper bigram substitution, an `X` is appended to the result if it's an odd character length.
- Repeat the phonteic mapping again. Note that because the phonetic map converts all characters to letters, the final plaintext consists entirely of words in NATO phonetic alphabet.
- Encrypt the plaintext by substituting every bigram using the `sub_bigrams` list, which is a shuffled list of bigrams.
- Print the ciphertext and write it to the file `ct.txt`.

To break the cipher, use the fact that the flag starts with "lactf{" as well as that the decoded plaintext should contain only NATO phonetic alphabet words to find the remaining substitutions.

### Demonstration
```
Starting Ciphertext:
RXENUEJGAIYVKMHEAKDANXDAXMMCMCZARPJUDANXXBAKNKSICIEFYTHEAKFKJVEMXMJXPFQHVXCICOXJMUHEAKEARQXRKKDJGXQVDZJWABIXRPQVDZFWXKWPYIDJFKJVPKHACACOXJPKHACATDTDVXCIEARQXRKKUJCARXRSDHHUHYFKJVEMXMVJYIMOWTXKYWFKJVMUHEAKUJCARXQZUJUWQJKZEHFKHACAPCNRTGVXCITFMOSEDPLXUJTGPRZWEILNVXCIFKJVPKHACACOXJMUHEAKEARQXRKKDJGXQVDZTTDHHUHYEARQXRKKSZYUMLUJTGPRZWHSKKXKUJCARXZWHACAFKJVLXUJTGPRZWQVDZHYYVQZUJPKHACACOXJSRRPJUFKJVLXUJLXUJIOABIXRPQVDZTTDHHUHYFKJVEMXMJXPFQHTFMODANXDAXMJXPFQHTFMODANXVJYIMOKMHEAKEARQXRKKFPRIVXCIVXCIUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCIHUCDFKJFHACAUBCPTGTZPRZWUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCISEDPTGPRZWDANXDPLLJFFKHACAQVDZFBQJKZEHMIUJPGEMHUHACARXENHUCDFKIXPRZWQVDZHYYVQZUJPKHACAHUCDFKJFHACAUBCPTGTZPRZWTFMOUEJGQNJILXUJUGDHHUHYEARQXRKKSZYUMLUJTGPRZWHSKKXKUJCARXZWHACAFKJVLXUJQVSIKGJXPFQHVXCIFKJVTGPRZWDANXMJDHHUHYEARQXRKKUEJGNOABIXRPQVDZKGPRZWTFMOVXCIUEJGNQEMNERPJUCOXJQVSIKGJXPFQHVXCIFKJVTGPRZWDANXYLYIDJDANXYIQJKZEHVPEMHUHACAQVDZFBQJKZEHMIUJRPYIDJDANXYIQJKZEHVPEMHUHACAUBCPTGZFQJKZEHNZPFQHHUCDFKJFHACAFKJVPRYVZJSIKGMLUJQJLLJFMIUJUWQJKZEHNZPFQHEARQXRKKSZYUJXPFQHDANXQCHACAHSKKXKUJCARXKMHEAKFKJVUWQJKZEHFKHACAPCNRTGVXCITFMOSEDPLXUJTGPRZWUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCISEDPTGPRZWDANXDPLLJFFKHACAUBCPTGZFQJKZEHNZPFQHHUCDFKJFHACAFKJVPRYVZJSIKGMLUJQJLLJFMIUJUWQJKZEHTTDHHUHYEARQXRKKSZYUMLUJTGPRZWHSKKXKUJCARXZWHACAFKJVLXUJPKHACAEARQXRKKVXCIUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCIKTVUMOSTRPJUUEJGFFSIKGQNJILXUJCSYIMOZWHACAEARQXRKKVXCIRXENUEJGAIYVKMHEAKRXENUEJGAIYVKMHEAKUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCICOXJMUHEAKEARQXRKKDJGXQVDZXKHEAKRXENTDTDCIEFYTHEAKFPRIUEJGDAXMQCHACACOXJSRRPJUFKJVLXUJLXUJUGDHHUHYEARQXRKKSZYUMLUJTGPRZWHSKKXKUJCARXZWHACAFKJVLXUJPKHACAEARQXRKKVXCICOXJMUHEAKEARQXRKKDJGXQVDZTTDHHUHYEARQXRKKSZYUMLUJTGPRZWHSKKXKUJCARXZWHACAFKJVLXUJIOABIXRPQVDZFWXKWPYIDJFKJVPKHACACOXJLFOOEDUJTGPRZWQVDZKGPRZWQVDZHYYVQZUJPKHACAUBCPTGZFQJKZEHORJUCOVXCIFKJVQVSIKGXBAKNKSIQVDZKGPRZWVXCIEARQXRKKQVDZSVLLJFMIUJPRYVWTXKYWVXCIFKJVLFOOEDUJTGPRZWQVDZEPRVSMGCCIEFRXPFQHHSKKXKFPRIVXCIWBNGQZUJCARXJUXMQCHACAHSKKXKVXCIUJCARXRSDHHUHYFKJVEMXMVJYIMOWTXKYWFKJVMUHEAKUJCARXQZUJAB
Starting Decryption:
______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
Adding in the known plaintext (Flag format):
LIMAINDIAMIKEALPHAALPHALIMAPAPAHOTELALPHACHARLIEHOTELALPHAROMEOLIMEINDIAECHOTANGOALPHANOVEMBERGOLFOSCARFOXTROTOSCARXRAYTANGOROMEOOSCARTANGOOSCARPAPAECHONOVEMBERCHARLIEUNIFORMROMEOLIMAYANKEEBRAVOROMEOALPHACHARLIEECHO_______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
Substituting all bigrams matching those in the known plaintext:
LIMAINDIAMIKEALPHAALPHALIMAPAPAHOTELALPHACHARLIEHOTELALPHAROMEOLIMEINDIAECHOTANGOALPHANOVEMBERGOLFOSCARFOXTROTOSCARXRAYTANGOROMEOOSCARTANGOOSCARPAPAECHONOVEMBERCHARLIEUNIFORMROMEOLIMAYANKEEBRAVOROMEOALPHACHARLIEECH________ROSCAR______ECHO__KE______CH__________ECHOROMEOOSCARTANGOALPHANOVEMBERGOLFOSCA__NIFORMNOVEMBER______CH________ERRACHARLI__SCARROME__CH______OSCARMIKEECHOOSCARTANG__OTELROME__CH__CH__OXTROTOSCA__NIFORMROMEOLIMEINDIA__KEALPHALIMEINDIA__KEALPHAYANKEEALPHANOVEMBER____ECHOECHO________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHOFO__RO__SCAR____________________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHO__________ALPH______ROSCAROSCA__________CH__OLFOSCARLIMAFO__ROTR____OSCARMIKEECHOOSCARFO__RO__SCAR______________KEINDI______CH__NIFORMNOVEMBER______CH________ERRACHARLI__SCARROME__CHOSIE__EINDIAECHOROME______ALPH__NIFORMNOVEMBERINDI__OXTROTOSCA________KEECHOINDI__OL__OTELTANGOSIE__EINDIAECHOROME______ALPH__ANGOALPHAN________OLFOSCAROSCA__________CHOTANGOALPHAN________OLFOSCAR________________NDIAFO__RO__SCARROME__IK__IE____CH________CH__________NDIANOVEMBER____EINDIAALPH__SCAR__ERRACHARLIEALPHAROME________ROSCAR______ECHO__KE______CH______________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHO__________ALPH______ROSCAR________________NDIAFO__RO__SCARROME__IK__IE____CH________CH__________NIFORMNOVEMBER______CH________ERRACHARLI__SCARROME__CHOOSCARNOVEMBERECHO________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHO____KE__OTELINDI__IE________CH__ANKE__SCARNOVEMBERECHOLIMAINDIAMIKEALPHALIMAINDIAMIKEALPHA________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHOTANGOALPHANOVEMBERGOLFOSCARALPHALIMAPAPAHOTELALPHA____INDIALIM__SCARTANG__OTELROME__CH__CH__NIFORMNOVEMBER______CH________ERRACHARLI__SCARROME__CHOOSCARNOVEMBERECHOTANGOALPHANOVEMBERGOLFOSCA__NIFORMNOVEMBER______CH________ERRACHARLI__SCARROME__CH__OXTROTOSCARXRAYTANGOROMEOOSCARTANG______CH______OSCA______OSCARMIKEECHOOSCAR________________ELTAECHOROMEOSIE__ACHARLIEOSCA______ECHONOVEMBEROSCA________CH__IKEBRAVOECHOROME______CH______OSCA________HOTELINDIA__ERRA____ECHO____EECHARLIELIM__SCAR__ERRAECHOCHARLIEUNIFORMROMEOLIMAYANKEEBRAVOROMEOALPHACHARLIEECHOX
```
The starting text alone decodes most of the ciphertext. Decode the rest by filling out the bigrams for where only one bigram will make the plaintext decode into phonetic words. For example, the only way to fill `__ ER RA` would be `SI` because `SIERRA` is the only phonetic word that can be formed. For longer strings of undecoded ciphertext such as `UN IF OR __ __ __ __ __ ELTA`, use the fact that the only word that fits the blank is `MN OV EM BE RD` as well as that the common 4 letter words are known to fill in the mapping. After completing the plaintext, simply reverse the phonetic mapping twice to obtain the flag.
```
Plaintext:
LIMAINDIAMIKEALPHAALPHALIMAPAPAHOTELALPHACHARLIEHOTELALPHAROMEOLIMAINDIAECHOTANGOALPHANOVEMBERGOLFOSCARFOXTROTOSCARXRAYTANGOROMEOOSCARTANGOOSCARPAPAECHONOVEMBERCHARLIEUNIFORMROMEOLIMAYANKEEBRAVOROMEOALPHACHARLIEECHONOVEMBEROSCARVICTORECHOMIKEBRAVOECHOROMEOZULUECHOROMEOOSCARTANGOALPHANOVEMBERGOLFOSCARUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOROMEOOSCARMIKEECHOOSCARTANGOHOTELROMEOECHOECHOFOXTROTOSCARUNIFORMROMEOLIMAINDIAMIKEALPHALIMAINDIAMIKEALPHAYANKEEALPHANOVEMBERKILOECHOECHOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOFOXTROTOSCARUNIFORMROMEOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOBRAVOROMEOALPHAVICTOROSCAROSCARNOVEMBERECHOGOLFOSCARLIMAFOXTROTROMEOOSCARMIKEECHOOSCARFOXTROTOSCARUNIFORMROMEOMIKEINDIAKILOECHOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOSIERRAINDIAECHOROMEOROMEOALPHAUNIFORMNOVEMBERINDIAFOXTROTOSCARROMEOMIKEECHOINDIAGOLFHOTELTANGOSIERRAINDIAECHOROMEOROMEOALPHATANGOALPHANOVEMBERGOLFOSCAROSCARNOVEMBERECHOTANGOALPHANOVEMBERGOLFOSCARUNIFORMNOVEMBERINDIAFOXTROTOSCARROMEOMIKESIERRAECHOVICTORECHONOVEMBERINDIANOVEMBERDELTAINDIAALPHAOSCARSIERRACHARLIEALPHAROMEONOVEMBEROSCARVICTORECHOMIKEBRAVOECHOROMEOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOBRAVOROMEOALPHAVICTOROSCARUNIFORMNOVEMBERINDIAFOXTROTOSCARROMEOMIKESIERRAECHOVICTORECHONOVEMBERUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOOSCARNOVEMBERECHOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOWHISKEYHOTELINDIASIERRAKILOECHOYANKEEOSCARNOVEMBERECHOLIMAINDIAMIKEALPHALIMAINDIAMIKEALPHAUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOTANGOALPHANOVEMBERGOLFOSCARALPHALIMAPAPAHOTELALPHAKILOINDIALIMAOSCARTANGOHOTELROMEOECHOECHOUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOOSCARNOVEMBERECHOTANGOALPHANOVEMBERGOLFOSCARUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHOFOXTROTOSCARXRAYTANGOROMEOOSCARTANGOZULUECHOROMEOOSCARROMEOOSCARMIKEECHOOSCARUNIFORMNOVEMBERDELTAECHOROMEOSIERRACHARLIEOSCARROMEOECHONOVEMBEROSCARVICTORECHOMIKEBRAVOECHOROMEOZULUECHOROMEOOSCARWHISKEYHOTELINDIASIERRAKILOECHOYANKEECHARLIELIMAOSCARSIERRAECHOCHARLIEUNIFORMROMEOLIMAYANKEEBRAVOROMEOALPHACHARLIEECHOX
After reversing the first phonetic mapping:
LIMAALPHACHARLIETANGOFOXTROTOPENCURLYBRACENOVEMBERZEROTANGOUNDERSCOREROMEOTHREEFOURLIMALIMAYANKEEUNDERSCOREFOURUNDERSCOREBRAVOONEGOLFROMEOFOURMIKEUNDERSCORESIERRAUNIFORMEIGHTSIERRATANGOONETANGOUNIFORMSEVENINDIAOSCARNOVEMBERUNDERSCOREBRAVOUNIFORMSEVENUNDERSCOREONEUNDERSCOREWHISKEYONELIMALIMAUNDERSCORETANGOALPHAKILOTHREEUNDERSCOREONETANGOUNDERSCOREFOXTROTZEROROMEOUNDERSCORENOVEMBERZEROWHISKEYCLOSECURLYBRACE
After reversing the second mapping:
LACTF{N0T_R34LLY_4_B1GR4M_SU8ST1TU7ION_BU7_1_W1LL_TAK3_1T_F0R_N0W}
```
Following the description to enter in the flag all lowercase, we get the flag `lactf{n0t_r34lly_4_b1gr4m_su8st1tu7ion_bu7_1_w1ll_tak3_1t_f0r_n0w}`
## Notes and Observations
- Since most of the plaintext is decoded from the known plaintext alone, rather than find the remaining substitutions, using a depth-first search to fill in the remaining substitutions works as well.
- Alternatively, using the fact that that the phonetic mapping is done twice, decoding the characters of the flag directly by matching the double-mapped characters with the partially decoded plaintext also works.